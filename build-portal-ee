# Author: Gergely Sz√°z <gergely.szaz@liferay.com>
# For building a certain branch from liferay-portal-ee.
# Parameter:
#	$1: Name of the branch to be built
# Environmental variables: 
# 	LIFERAY_BUILD: path to the build folder
#	LIFERAY_GITHUB: path to the liferay-portal-ee repository

# check if parameter was given
if [ $# -eq 0 ]
  then
	echo "No branchname supplied"
	exit 1
fi

# save current state and checkout branch
BRANCH=$1
SPATH=$LIFERAY_GITHUB
cd $SPATH
ORIGINAL=$(git branch | sed -n -e 's/^\* \(.*\)/\1/p')
git stash
git checkout $BRANCH

build

# restore original state
cd $SPATH
git clean -fd
git reset --hard HEAD
git checkout $ORIGINAL
git stash apply
